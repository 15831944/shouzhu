

前一段时间，编制了一个批量输出自定义属性及缩略图到Excel的宏，受到了大家的普遍关注。

但该宏也有局限性，大家知道，文件夹下的模型文件并不都是有用的，有的只是参考或过渡模型，只有装配体中的零部件都有用。

鉴于此，本人又编制了在装配体中批量输出文件属性及缩略图到Excel的宏，根据一些朋友的建言建议，通过一段时间的不断优化，

先后增加了：

	1.缩略图可按线框模式显示；

	2.缩略图可插入单元格批注中，一般不显示，只有鼠标移动到该单元格时，才会显示缩略图；

	3.要提取的属性可修改、增删、排序，设置好后，会自动保存到初始化文件中，以后再无需设置

	4.要提取的属性既可全是自定义，也可全是配置特定，还可自定义与配置特定混合使用；

	5.在处理模型文件时，也增加了表示进度的进度条；
	
	6.所属装配代号可通过选择与文档的代号属性相关联；

因为该宏与前面的宏程序功能上相差甚远了，所以我对前面的宏程序不再更新了！主要以这个程序为蓝本，进行更新!

所以，该程序现在叫装配体明细表统计，我另开一贴进行发布，希望大家试用，并提出建议！

注意：这里的明细表不是指装配体中生成的明细表，而是通过提取装配体中所有零部件属性生成的。

当然，也是和装配体中生成的明细表是异曲同工的。



'使用说明: 该宏可以按照用户要求，批量输出打开的装配体中所有零部件指定的属性及缩略图到excel文件中

''前提条件： 1.当前所打开的文档必须是装配体；
'
''           2.运行该程序前要将装配体中的轻化零部件全部进行还原，否则对轻化的零部件不进行统计；
'
''           3.每个零部件的文档属性中尽可能包含要提取的属性名称，并确定好该属性是自定义还是配置特定
'
'最后结果: 该宏将批量输出打开的solidworks装配体所有零部件中所包含的零部件质量，密度，数量，所属装配号
'
'          以及自定义属性和配置特定属性及缩略图，并存储到指定的excel文件。
'
'特点：

'   1.该宏可同时输出零部件自定义属性以及配置特定属性；
'
'   2.用户在使用该宏时，可自己设置所提取的属性名称及类别（自定义/配置特定），可新增,也可编辑、删除
'
'     前后排序等。当设定完成后，将自动记录到初始化文件中，以后每次使用可无需设置；
'
'   3.该宏可自动统计输出每个零部件总数量以及总重；
'
'   4.该宏可统计输出零部件所属装配代号；
'
'   5.该宏可输出所有零部件缩略图，缩略图即可是上色的（速度很快），也可是线框的（速度较慢）；
'
'   6.插入缩略图时，即可插入到单元格中，也可附着到每行文件名的批注中
'
'   7.对于封套,Bom排除零部件，既可以统计进去，也可排除
'
'作者：lhl，2017.08.15
'
'版本：V2.5